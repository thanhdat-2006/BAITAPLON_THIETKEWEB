<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danh Sách Tour - Viettravel</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>

    <header>
        <div class="container">
            <a href="index.html" class="logo">
                 <img src="assets/images/logoweb.png" alt="Viettravel Logo" class="logo-img">
            </a>
            <button id="nav-toggle" class="nav-toggle" aria-label="Mở menu" aria-expanded="false">
                <span class="hamburger"></span>
            </button>
            <nav>
                <ul class="nav-links">
                    <li><a href="index.html">Trang chủ</a></li>
                    <li><a href="destinations.html">Điểm đến</a></li>
                    <li><a href="tours.html" class="active">Tours</a></li>
                    <li><a href="hotels.html">Dịch vụ</a></li>
                    <li><a href="booking-history.html">Lịch sử</a></li>
                    <li><a href="evaluations.html">Đánh giá</a></li>
                    <li><a href="contact.html" class="btn-contact">Liên hệ</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="page-banner">
        <div class="banner-content">
            <h2>Tour Du Lịch Trọn Gói</h2>
            <p>Giá tốt - Chất lượng cao - Đặt ngay hôm nay</p>
        </div>
    </section>

    <section class="section-padding container">
        <h2 class="section-title">Danh Sách Tours</h2>

        <!-- container để main.js render danh sách tour -->
        <div id="tours-container" class="tour-grid"></div>
    </section>

    <footer>
        <div class="container footer-content">
            <div class="footer-col">
                <div class="footer-logo">
                    <img src="assets/images/logoweb.png" alt="Viettravel Logo">
                </div>
                <p>Thổi bùng đam mê du lịch và khám phá.</p>
                <div id="footer-datetime" class="footer-datetime" aria-live="polite"></div>
            </div>

            <div class="footer-col">
                <h4>Liên kết</h4>
                <ul>
                    <li><a href="index.html">Trang chủ</a></li>
                    <li><a href="destinations.html">Điểm đến</a></li>
                    <li><a href="tours.html">Tours</a></li>
                    <li><a href="hotels.html">Dịch vụ</a></li>
                    <li><a href="booking-history.html">Lịch sử</a></li>
                    <li><a href="evaluations.html">Đánh giá</a></li>
                    <li><a href="contact.html">Liên hệ</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h4>Đối tác hợp tác</h4>
                <div class="partners-list" aria-label="Đối tác hợp tác">
                    <div class="partner-item">
                        <a href="https://www.traveloka.com/vi-vn" target="_blank" rel="noopener noreferrer">
                            <img src="assets/images/partners/partner_1.jpg" alt="Đối tác 1">
                        </a>
                    </div>
                    <div class="partner-item">
                        <a href="https://www.flightcentre.com.au/" target="_blank" rel="noopener noreferrer">
                            <img src="assets/images/partners/partner_2.jpg" alt="Đối tác 2">
                        </a>
                    </div>
                    <div class="partner-item">
                        <a href="https://www.ivivu.com/" target="_blank" rel="noopener noreferrer">
                            <img src="assets/images/partners/partner_3.jpg" alt="Đối tác 3">
                        </a>
                    </div>
                    <div class="partner-item">
                        <a href="https://www.americanexpress.com/" target="_blank" rel="noopener noreferrer">
                            <img src="assets/images/partners/partner_4.jpg" alt="Đối tác 4">
                        </a>
                    </div>
                </div>
            </div>

            <div class="footer-col">
                <h4>Phương thức thanh toán</h4>
                <div class="payments-list" aria-label="Đối tác thanh toán">
                    <a href="https://www.visa.com" target="_blank" rel="noopener noreferrer" class="payment-item">
                        <img src="assets/images/payments/payment_1.png" alt="Visa">
                    </a>
                    <a href="https://www.mastercard.com" target="_blank" rel="noopener noreferrer" class="payment-item">
                        <img src="assets/images/payments/payment_2.png" alt="Mastercard">
                    </a>
                    <a href="https://www.vn.jcb/vi/index.html" target="_blank" rel="noopener noreferrer" class="payment-item">
                        <img src="assets/images/payments/payment_3.png" alt="JCB">
                    </a>
                    <a href="https://www.momo.vn/" target="_blank" rel="noopener noreferrer" class="payment-item">
                        <img src="assets/images/payments/payment_4.png" alt="Momo">
                    </a>
                </div>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2025 Viettravel. All rights reserved.|Support 24/24</p>
        </div>
    </footer>

    <div id="booking-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3>Đặt Tour Du Lịch</h3>
            <p id="selected-tour-name" style="margin-bottom:15px; color:#00b894; font-weight:bold;"></p>
            
            <form id="booking-form" class="booking-form">
                <div class="form-group">
                    <label>Họ và tên:</label>
                    <input type="text" id="cus-name" required placeholder="Nhập tên của bạn">
                </div>
                <div class="form-group">
                    <label>Số điện thoại:</label>
                    <input type="tel" id="cus-phone" required placeholder="Nhập SĐT">
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="email" id="cus-email" required placeholder="Nhập email">
                </div>
                <div class="form-group">
                    <label>Ngày khởi hành:</label>
                    <input type="date" id="start-date" required>
                </div>
                <div class="form-group">
                    <label>Số người:</label>
                    <input type="number" id="cus-people" min="1" value="1" required>
                </div>
                <button type="submit" class="btn-primary" style="width:100%; border:none; cursor:pointer;">Xác Nhận</button>
            </form>
        </div>
    </div>

    <script src="assets/js/main.js"></script>

    <script>
        const bookingForm = document.getElementById('booking-form');
        const emailInput = document.getElementById('cus-email');

        bookingForm.addEventListener('submit', function(e) {
            e.preventDefault();

            // Validate email
            const email = emailInput.value.trim();
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

            if (!email || !emailRegex.test(email)) {
                // Hiển thị thông báo lỗi mà không dùng alert
                const errorMsg = document.createElement('div');
                errorMsg.style.cssText = 'position:fixed; top:20px; right:20px; background:#d32f2f; color:white; padding:16px; border-radius:8px; z-index:9999; font-weight:600;';
                errorMsg.textContent = 'Email không đúng định dạng! Vui lòng nhập email hợp lệ.';
                document.body.appendChild(errorMsg);
                setTimeout(() => errorMsg.remove(), 3000);
                emailInput.focus();
                return;
            }

            // Lấy dữ liệu từ form
            const name = document.getElementById('cus-name').value.trim();
            const phone = document.getElementById('cus-phone').value.trim();
            const startDate = document.getElementById('start-date').value;
            const people = document.getElementById('cus-people').value;
            const tourNameEl = document.getElementById('selected-tour-name');
            const tourPriceEl = document.getElementById('selected-tour-price');

            if (!name || !phone || !startDate || !people) {
                const errorMsg = document.createElement('div');
                errorMsg.style.cssText = 'position:fixed; top:20px; right:20px; background:#d32f2f; color:white; padding:16px; border-radius:8px; z-index:9999; font-weight:600;';
                errorMsg.textContent = 'Vui lòng điền đầy đủ thông tin!';
                document.body.appendChild(errorMsg);
                setTimeout(() => errorMsg.remove(), 3000);
                return;
            }

            // Lưu booking với đầy đủ thông tin
            const bookingData = {
                id: '#' + Math.floor(Math.random() * 100000),
                tourName: tourNameEl ? tourNameEl.textContent : 'Tour chưa chọn',
                price: tourPriceEl ? tourPriceEl.textContent : '0',
                name: name,
                phone: phone,
                email: email,
                startDate: startDate,
                people: people,
                status: 'Chờ xác nhận',
                bookingDate: new Date().toISOString()
            };

            const bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
            bookings.push(bookingData);
            localStorage.setItem('bookings', JSON.stringify(bookings));

            // Hiển thị thông báo thành công + redirect
            const successMsg = document.createElement('div');
            successMsg.style.cssText = 'position:fixed; top:20px; right:20px; background:#4caf50; color:white; padding:16px; border-radius:8px; z-index:9999; font-weight:600;';
            successMsg.textContent = 'Đặt tour thành công! Mã tour: ' + bookingData.id;
            document.body.appendChild(successMsg);

            document.getElementById('booking-modal').classList.remove('show');
            bookingForm.reset();

            // Redirect về lịch sử sau 2 giây
            setTimeout(() => {
                window.location.href = 'booking-history.html';
            }, 2000);
        });

        document.addEventListener('DOMContentLoaded', function () {
  // nếu URL chứa #booking-form hoặc ?focus=booking sẽ cuộn và focus form
  const shouldOpen = location.hash === '#booking-form' || new URLSearchParams(location.search).get('focus') === 'booking';
  if (!shouldOpen) return;
  const form = document.getElementById('booking-form') || document.querySelector('form.booking-form') || document.querySelector('.booking-form');
  if (!form) return;
  // cuộn mượt tới form và focus input đầu tiên
  setTimeout(() => {
    form.scrollIntoView({ behavior: 'smooth', block: 'center' });
    const first = form.querySelector('input, textarea, select, button');
    if (first) first.focus();
  }, 120);
});
    </script>
</body>
</html>